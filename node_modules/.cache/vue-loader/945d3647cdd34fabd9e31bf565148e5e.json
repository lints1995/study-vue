{"remainingRequest":"/Users/lin/Career/demo_vue/node_modules/_vue-loader@15.9.7@vue-loader/lib/index.js??vue-loader-options!/Users/lin/Career/demo_vue/src/components/c-form/c-form-item.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lin/Career/demo_vue/src/components/c-form/c-form-item.vue","mtime":1624522085912},{"path":"/Users/lin/Career/demo_vue/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lin/Career/demo_vue/node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/lin/Career/demo_vue/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lin/Career/demo_vue/node_modules/_vue-loader@15.9.7@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBTY2hlbWEgZnJvbSAiYXN5bmMtdmFsaWRhdG9yIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiYy1mb3JtLWl0ZW0iLAogIGluamVjdDogWyJmb3JtIl0sIC8vIOaOpeaUtueItue6p+S8oOmAkueahOWPguaVsAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBlcnJvcjogIiIsCiAgICB9OwogIH0sCiAgcHJvcHM6IHsKICAgIGxhYmVsOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgIH0sCiAgICBwcm9wOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgIH0sCiAgfSwKICBtb3VudGVkKCkgewogICAgLy8g55uR5ZCs5a2Q57uE5Lu255qE6aqM6K+B6YCa55+l77yM5omn6KGM5qCh6aqM5Yqo5L2cCiAgICB0aGlzLiRvbigidmFsaWRhdGUiLCAoKSA9PiB7CiAgICAgIHRoaXMudmFsaWRhdGUoKTsKICAgIH0pOwogIH0sCiAgbWV0aG9kczogewogICAgdmFsaWRhdGUoKSB7CiAgICAgIC8vIOW9k+WJjeinhOWImQogICAgICBjb25zdCBjdXJyZW50UnVsZXMgPSB0aGlzLmZvcm0ucnVsZXNbdGhpcy5wcm9wXTsKICAgICAgLy8g5b2T5YmN5YC8CiAgICAgIGNvbnN0IGN1cnJlbnRWYWx1ZSA9IHRoaXMuZm9ybS5tb2RlbFt0aGlzLnByb3BdOwoKICAgICAgLy8g5qCh6aqM5o+P6L+w5a+56LGhCiAgICAgIGNvbnN0IGRlc2MgPSB7IFt0aGlzLnByb3BdOiBjdXJyZW50UnVsZXMgfTsKCiAgICAgIC8vIOWunuS+i+WMluagoemqjOWvueixoQogICAgICBjb25zdCBzY2hlbWEgPSBuZXcgU2NoZW1hKGRlc2MpOwogICAgICByZXR1cm4gc2NoZW1hLnZhbGlkYXRlKHsgW3RoaXMucHJvcF06IGN1cnJlbnRWYWx1ZSB9LCAoZXJyb3JzKSA9PiB7CiAgICAgICAgaWYgKGVycm9ycykgewogICAgICAgICAgLy8g5qCh6aqM5aSx6LSlCiAgICAgICAgICB0aGlzLmVycm9yID0gZXJyb3JzWzBdLm1lc3NhZ2U7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIOagoemqjOmAmui/hwogICAgICAgICAgdGhpcy5lcnJvciA9ICIiOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["c-form-item.vue"],"names":[],"mappings":";;;;;;;;;AASA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"c-form-item.vue","sourceRoot":"src/components/c-form","sourcesContent":["<template>\n  <div class=\"e-form-item\">\n    <label v-if=\"label\">{{ label }}</label>\n    <slot></slot>\n    <p v-if=\"error\">{{ error }}</p>\n  </div>\n</template>\n\n<script>\nimport Schema from \"async-validator\";\n\nexport default {\n  name: \"c-form-item\",\n  inject: [\"form\"], // 接收父级传递的参数\n  data() {\n    return {\n      error: \"\",\n    };\n  },\n  props: {\n    label: {\n      type: String,\n    },\n    prop: {\n      type: String,\n    },\n  },\n  mounted() {\n    // 监听子组件的验证通知，执行校验动作\n    this.$on(\"validate\", () => {\n      this.validate();\n    });\n  },\n  methods: {\n    validate() {\n      // 当前规则\n      const currentRules = this.form.rules[this.prop];\n      // 当前值\n      const currentValue = this.form.model[this.prop];\n\n      // 校验描述对象\n      const desc = { [this.prop]: currentRules };\n\n      // 实例化校验对象\n      const schema = new Schema(desc);\n      return schema.validate({ [this.prop]: currentValue }, (errors) => {\n        if (errors) {\n          // 校验失败\n          this.error = errors[0].message;\n        } else {\n          // 校验通过\n          this.error = \"\";\n        }\n      });\n    },\n  },\n};\n</script>\n"]}]}